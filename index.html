<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inicio ¬∑ DENTOVA ‚Äî Panel Futurista</title>

  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    // ‚úÖ Supabase
    const supabase = createClient(
      "https://dmcfrmpqlkrqbpjhrfyo.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRtY2ZybXBxbGtycWJwamhyZnlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5MzU0MDIsImV4cCI6MjA3ODUxMTQwMn0.YY_6t_lCTs5mK-a_eEdBFa6l9_NBM3B4YDtWOXayCBE"
    );

    const LOGIN_URL = "https://cacg1022.github.io/ODONTOLOGIA/login.html";

    // ‚úÖ LINKS
    const URLS = {
      gestiondepermisos: "https://cacg1022.github.io/ODONTOLOGIA/permisos.html",
      agendar: "https://cacg1022.github.io/ODONTOLOGIA/agendamientos.html",
      plan: "https://cacg1022.github.io/ODONTOLOGIA/plandetratamiento.html",
      historia: "https://cacg1022.github.io/ODONTOLOGIA/historia-clinica.html",
      hoy: "https://cacg1022.github.io/ODONTOLOGIA/pacienteshoy.html",
      rips: "#",
      registro: "https://cacg1022.github.io/ODONTOLOGIA/registro.html",
      usuarios: "https://cacg1022.github.io/ODONTOLOGIA/admin-roles.html",
      precios: "https://cacg1022.github.io/ODONTOLOGIA/actualizacion-precios.html",
      profesionales: "https://cacg1022.github.io/ODONTOLOGIA/profesionales-admin.html",

      // ‚úÖ NUEVO: Facturaci√≥n (solo admin)
      facturacion: "https://cacg1022.github.io/ODONTOLOGIA/facturacion.html",
      reporte_pacientes: "https://cacg1022.github.io/ODONTOLOGIA/reporte-pacientes.html",
      reporte_ventas: "https://cacg1022.github.io/ODONTOLOGIA/reportes.html",

      // ‚úÖ NUEVO: Gastos (misma pesta√±a)
      gastos: "https://cacg1022.github.io/ODONTOLOGIA/gastos.html",
    };

    // ‚úÖ Admin por email
    const ADMIN_EMAIL = "Camilo-1000@hotmail.com".toLowerCase();

    function setDisabled(el, disabled, reason = "No autorizado") {
      if (!el) return;

      if (disabled) {
        el.classList.add("disabled");
        el.setAttribute("aria-disabled", "true");
        el.dataset.disabledReason = reason;

        el.onclick = (e) => {
          e.preventDefault();
          alert("üö´ Acceso restringido: " + reason);
        };
      } else {
        el.classList.remove("disabled");
        el.removeAttribute("aria-disabled");
        delete el.dataset.disabledReason;

        if (el.onclick) el.onclick = null;
      }
    }

    function wireNav(id, url, mode="open") {
      const el = document.getElementById(id);
      if (!el) return;

      el.onclick = (e) => {
        e.preventDefault();

        if (el.classList.contains("disabled")) return;

        if (!url || url === "#") {
          alert("‚ö†Ô∏è Esta opci√≥n a√∫n no tiene URL asignada.");
          return;
        }
        if (mode === "href") window.location.href = url;
        else window.open(url, "_blank");
      };
    }

    // ‚úÖ Lee rol desde profiles
    async function cargarRolDesdeProfiles(userId) {
      try {
        const { data, error } = await supabase
          .from("profiles")
          .select("role")
          .eq("id", userId)
          .single();

        if (error) {
          console.warn("No se pudo leer profiles.role:", error.message);
          return null;
        }
        return data?.role || null;
      } catch (e) {
        console.warn("Error leyendo role:", e);
        return null;
      }
    }

    // ‚úÖ Normaliza nombres de m√≥dulos para que coincidan aunque tengan .html
    function normModulo(s) {
      return String(s || "")
        .trim()
        .toLowerCase()
        .replace(/^\/+/, "")
        .replace(/\.html$/i, "");
    }

    // ‚úÖ Mapa: bot√≥n -> modulo (DEBE coincidir con lo que tienes en modulos_permisos)
    const MODULE_MAP = {
      "go-reporte-ventas":    "reportes",
      "go-agendar":           "agendamientos",
      "go-gestiondepermisos": "permisos",
      "go-historia":          "historia_clinica",
      "go-reporte-pacientes": "reporte_pacientes",
      "go-plan":              "plandetratamiento",
      "go-precios":           "actualizacion_precios",
      "go-usuarios":          "admin-roles",
      "go-profesionales":     "profesionales-admin",
      "go-facturacion":       "facturacion",
      "go-registro":          "registro",

      "go-hoy":               "pacienteshoy",

      "go-rips":              "rips",

      // ‚úÖ NUEVO: Gastos (debe existir como "gastos" en modulos_permisos.modulo)
      "go-gastos":            "gastos",
    };

    function getModuloCandidates(mod) {
      const m = normModulo(mod);
      const out = new Set([m, `${m}.html`]);
      if (m === "permisos") out.add("admin-roles");
      return Array.from(out);
    }

    async function cargarPermisosPorRol() {
      try {
        const { data, error } = await supabase
          .from("modulos_permisos")
          .select("modulo, admin, doctor, auxiliar, paciente");

        if (error) throw error;

        const map = {};
        (data || []).forEach(row => {
          const base = normModulo(row.modulo);
          map[base] = row;
          map[`${base}.html`] = row;
        });

        return map;
      } catch (e) {
        console.warn("No se pudo cargar modulos_permisos:", e?.message || e);
        return null;
      }
    }

    function puedeAcceder(permisosMap, modulo, roleKey) {
      if (!permisosMap) return false;

      const candidates = getModuloCandidates(modulo);
      for (const cand of candidates) {
        const row = permisosMap[cand];
        if (row && row[roleKey] === true) return true;
      }
      return false;
    }

    async function verificarSesionYPermisos() {
      const { data: { session } } = await supabase.auth.getSession();

      if (!session) {
        window.location.href = LOGIN_URL;
        return;
      }

      const email = (session.user?.email || "").toLowerCase();

      const u = document.getElementById("user-email");
      if (u) u.textContent = session.user?.email || "Usuario autenticado";

      const roleRaw = await cargarRolDesdeProfiles(session.user.id);
      const roleNorm = String(roleRaw || "").toLowerCase().trim();

      const roleEl = document.getElementById("user-role");
      if (roleEl) roleEl.textContent = roleRaw ? `Rol: ${roleRaw}` : "Rol: (sin rol)";

      const roleKey =
        roleNorm === "admin" ? "admin" :
        roleNorm === "doctor" ? "doctor" :
        roleNorm === "auxiliar" ? "auxiliar" :
        "paciente";

      const finalRoleKey = (email === ADMIN_EMAIL) ? "admin" : roleKey;

      const permisosMap = await cargarPermisosPorRol();

      for (const [btnId, modulo] of Object.entries(MODULE_MAP)) {
        const el = document.getElementById(btnId);

        const ok = puedeAcceder(permisosMap, modulo, finalRoleKey);

        const reason = !permisosMap
          ? "No se pudieron cargar permisos"
          : `No autorizado para tu rol`;

        setDisabled(el, !ok, reason);
      }

      wireNav("go-agendar", URLS.agendar, "href");
      wireNav("go-gestiondepermisos", URLS.gestiondepermisos, "open");
      wireNav("go-historia", URLS.historia, "href");
      wireNav("go-plan", URLS.plan, "href");
      wireNav("go-hoy", URLS.hoy, "href");
      wireNav("go-rips", URLS.rips, "href");
      wireNav("go-registro", URLS.registro, "href");
      wireNav("go-usuarios", URLS.usuarios, "href");
      wireNav("go-precios", URLS.precios, "href");
      wireNav("go-profesionales", URLS.profesionales, "href");
      wireNav("go-facturacion", URLS.facturacion, "href");
      wireNav("go-reporte-pacientes", URLS.reporte_pacientes, "href");
      wireNav("go-reporte-ventas", URLS.reporte_ventas, "href");

      // ‚úÖ NUEVO: Gastos (misma pesta√±a)
      wireNav("go-gastos", URLS.gastos, "href");

      const t = document.getElementById("today");
      if (t) {
        t.textContent = new Date().toLocaleDateString("es-CO", {
          year:"numeric", month:"long", day:"2-digit"
        });
      }

      const y = document.getElementById("year");
      if (y) y.textContent = new Date().getFullYear();
    }
// =========================
// ‚úÖ CONTAR PACIENTES √öNICOS (CORREGIDO)
// =========================
async function cargarPacientes() {
  try {
    const { data, error } = await supabase
      .from("HISTORIAS CLINICAS")
      .select('"Numero de Identificacion"');

    if (error) throw error;

    const unicos = new Set(
      (data || [])
        .map(r => r["Numero de Identificacion"])
        .filter(v => v !== null && v !== "")
    );

    const el = document.getElementById("pacientes-value");
    if (el) el.textContent = unicos.size;

    const hint = document.getElementById("pacientes-hint");
    if (hint) hint.textContent = "Pacientes √∫nicos";

  } catch (e) {
    console.error("Error cargando pacientes:", e);
    const el = document.getElementById("pacientes-value");
    if (el) el.textContent = "‚Äî";
  }
}



    // =========================
    // ‚úÖ CONTAR CITAS DE HOY
    // =========================
    async function cargarCitasHoy() {
      try {
        const inicioDia = new Date();
        inicioDia.setHours(0,0,0,0);

        const finDia = new Date();
        finDia.setHours(23,59,59,999);

        const { count, error } = await supabase
          .from("citas")
          .select("id", { count: "exact", head: true })
          .gte("inicio", inicioDia.toISOString())
          .lte("inicio", finDia.toISOString());

        if (error) throw error;

        const el = document.getElementById("citas-hoy-value");
        if (el) el.textContent = count ?? 0;

        const hint = document.getElementById("citas-hoy-hint");
        if (hint) hint.textContent = "Actualizado en tiempo real";

      } catch (e) {
        console.error("Error cargando citas de hoy:", e);
      }
    }

verificarSesionYPermisos();
    cargarCitasHoy();
    cargarPacientes();

    supabase.auth.onAuthStateChange((_event, session) => {
      if (!session) window.location.href = LOGIN_URL;
    });

    window.cerrarSesion = async () => {
      try { await supabase.auth.signOut(); } catch(e) {}
      try { localStorage.removeItem("usuario_logueado"); } catch(e) {}
      window.location.href = LOGIN_URL;
    };
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#041722;
      --bg1:#072738;
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.04);
      --stroke: rgba(255,255,255,.16);
      --border: rgba(255,255,255,.18);
      --neon:#20f0d0;
      --neon2:#66ffb5;
      --neon3:#24b7ff;
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --shadow: 0 22px 60px rgba(0,0,0,.45);
      --shadow2: 0 16px 40px rgba(0,0,0,.35);
      --radius: 22px;
      --radius2: 18px;
      --ok:#2cff9a;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      overflow-x:hidden;
      background:
        radial-gradient(900px 520px at 20% 20%, rgba(32,240,208,.22), transparent 60%),
        radial-gradient(780px 520px at 85% 70%, rgba(36,183,255,.18), transparent 62%),
        radial-gradient(540px 380px at 70% 18%, rgba(102,255,181,.12), transparent 60%),
        linear-gradient(145deg, var(--bg0), var(--bg1));
      padding: 26px 16px 44px;
    }

    /* HUD grid */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.28;
      background:
        linear-gradient(rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size: 44px 44px;
      mask-image: radial-gradient(circle at 50% 40%, rgba(0,0,0,1), rgba(0,0,0,.15) 60%, transparent 78%);
    }

    /* Edge glow */
    body::after{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(30px 420px at left 50%, rgba(32,240,208,.62), transparent 70%),
        radial-gradient(30px 420px at right 50%, rgba(32,240,208,.62), transparent 70%);
      filter: blur(1px);
      opacity:.85;
    }

    .wrap{
      width:min(1200px, 100%);
      margin: 0 auto;
      display:flex;
      flex-direction:column;
      gap: 18px;
    }

    /* ===== Topbar ===== */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 14px 14px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 16px 40px rgba(0,0,0,.26);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      position: relative;
      overflow:hidden;
    }
    .topbar::before{
      content:"";
      position:absolute; inset:-140px -160px auto auto;
      width: 320px; height: 320px;
      background: radial-gradient(circle, rgba(32,240,208,.20), transparent 60%);
      pointer-events:none;
    }
    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 0;
    }
    .logo{
      width: 40px; height: 40px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(32,240,208,.25), rgba(36,183,255,.18));
      border: 1px solid rgba(255,255,255,.14);
      display:grid; place-items:center;
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
      flex: 0 0 auto;
    }
    .logo svg{ width: 22px; height: 22px; opacity:.95; }
    .logo svg path{ fill: rgba(255,255,255,.92); }

    .brand-title{ display:flex; flex-direction:column; line-height:1.05; min-width:0; }
    .brand-title .kicker{
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(255,255,255,.70);
      font-weight: 700;
    }
    .brand-title .name{
      font-size: 16px;
      font-weight: 900;
      letter-spacing: -.02em;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .top-actions{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .chip{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      color: rgba(255,255,255,.78);
      font-weight: 700;
      font-size: 12px;
      white-space:nowrap;
    }
    .chip .dot{
      width: 10px; height: 10px; border-radius:999px;
      background: var(--neon);
      box-shadow: 0 0 0 4px rgba(32,240,208,.18);
    }

    .mini-meta{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    #user-email{
      font-weight: 900;
      color: rgba(255,255,255,.92);
      font-size: 13px;
    }
    #user-role{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(32,240,208,.26);
      background: rgba(32,240,208,.12);
      color: rgba(255,255,255,.90);
      font-weight: 900;
      font-size: 12px;
      letter-spacing:.04em;
      white-space:nowrap;
    }
    #user-role::before{
      content:"";
      width:8px; height:8px;
      border-radius:999px;
      background: var(--neon2);
      box-shadow: 0 0 0 4px rgba(102,255,181,.18);
    }

    .btn{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.88);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 900;
      letter-spacing:.04em;
      text-transform: uppercase;
      box-shadow: 0 12px 24px rgba(0,0,0,.22);
      transition: transform .10s ease, filter .12s ease, border-color .12s ease;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      filter: brightness(1.05);
      border-color: rgba(32,240,208,.35);
    }
    .btn.primary{
      background: linear-gradient(135deg, rgba(32,240,208,.22), rgba(102,255,181,.18));
      border-color: rgba(32,240,208,.28);
    }

    /* ===== Hero ===== */
    .hero{
      border-radius: var(--radius);
      border: 1px solid rgba(32,240,208,.22);
      background:
        radial-gradient(900px 520px at 25% 0%, rgba(32,240,208,.18), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      overflow:hidden;
      position: relative;
      padding: 26px;
    }
    .hero::before{
      content:"";
      position:absolute; inset: 14px;
      border-radius: calc(var(--radius) - 10px);
      border: 1px solid rgba(255,255,255,.12);
      pointer-events:none;
    }
    .hero-grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items:stretch;
    }
    @media (max-width: 980px){ .hero-grid{ grid-template-columns: 1fr; } }

    .headline{
      margin: 0;
      font-size: clamp(26px, 4.2vw, 52px);
      line-height: 1.02;
      letter-spacing: -0.04em;
      font-weight: 900;
      text-transform: uppercase;
    }
    .headline .neon{
      background: linear-gradient(90deg, var(--neon), var(--neon2), var(--neon3));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      text-shadow: 0 0 22px rgba(32,240,208,.20);
    }
    .sub{
      margin: 10px 0 0;
      color: rgba(255,255,255,.78);
      font-size: 14px;
      line-height: 1.5;
      max-width: 62ch;
    }

    .cta-row{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 14px;
    }
    .cta-big{
      padding: 14px 18px;
      border-radius: 999px;
      border: 1px solid rgba(32,240,208,.30);
      background: linear-gradient(135deg, rgba(32,240,208,.22), rgba(102,255,181,.14));
      color: rgba(255,255,255,.92);
      font-weight: 1000;
      letter-spacing: .08em;
      text-transform: uppercase;
      cursor:pointer;
      box-shadow: 0 18px 38px rgba(0,0,0,.28);
      transition: transform .10s ease, filter .12s ease;
    }
    .cta-big:hover{ transform: translateY(-1px); filter: brightness(1.06); }
    .cta-ghost{
      padding: 14px 18px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.86);
      font-weight: 900;
      letter-spacing:.06em;
      text-transform: uppercase;
      cursor:pointer;
    }

    /* ===== Resumen r√°pido ===== */
    .hero-right{
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      box-shadow: var(--shadow2);
      padding: 16px;
position: relative;
overflow: visible;
}
    .panel-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom: 10px;
      position:relative;
      z-index:2;
    }
    .panel-title h3{
      margin:0;
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: rgba(255,255,255,.72);
    }
    .status-pill{
      font-size: 11px;
      font-weight: 900;
      letter-spacing:.10em;
      text-transform: uppercase;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(32,240,208,.26);
      background: rgba(32,240,208,.12);
      color: rgba(255,255,255,.90);
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .status-pill::before{
      content:"";
      width:8px; height:8px;
      border-radius:999px;
      background: var(--neon2);
      box-shadow: 0 0 0 4px rgba(102,255,181,.18);
    }

    .kpi-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      position:relative;
      z-index:2;
    }
    .kpi{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      padding: 12px;
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
position: relative;
z-index: 1;
}
    .kpi .label{
      font-size: 11px;
      color: rgba(255,255,255,.70);
      letter-spacing:.10em;
      text-transform: uppercase;
      font-weight: 800;
    }
    .kpi .value{
      margin-top: 6px;
      font-size: 22px;
      font-weight: 1000;
      letter-spacing: -.02em;
    }
    .kpi .hint{
      margin-top: 6px;
      font-size: 12px;
      color: rgba(255,255,255,.70);
    }

    .circuit{
      pointer-events:none;
      position:absolute;
      inset:0;
      opacity:.65;
      background:
        radial-gradient(circle at 20% 30%, rgba(32,240,208,.14), transparent 55%),
        radial-gradient(circle at 80% 60%, rgba(36,183,255,.10), transparent 55%);
      pointer-events:none;
      z-index:0;
    }

    /* ‚úÖ SCANLINE (la l√≠nea que baja) */
    .scanline{
  pointer-events:none;
  position:absolute;
  left:0;
  right:0;
  height:2px;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(32,240,208,.95),
    transparent
  );
  opacity:.75;
  filter: blur(.3px);
  animation: scan 4.2s linear infinite;
  z-index: 20; /* üî• M√ÅS ALTO QUE LA MUELA */
}

    @keyframes scan {
      0%{ top:-6px; }
      100%{ top: calc(100% + 6px); }
    }

    /* ===== Modules ===== */
    .modules{
      margin-top: 18px;
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
    }
    @media (max-width: 980px){ .modules{ grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 560px){ .modules{ grid-template-columns: 1fr; } }

    .module{
      border-radius: var(--radius2);
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: 0 16px 34px rgba(0,0,0,.22);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 14px;
      position: relative;
      overflow:hidden;
      transition: transform .12s ease, border-color .12s ease, filter .12s ease;
      cursor:pointer;
      text-decoration:none;
      color: rgba(255,255,255,.92);
      display:block;
      min-height: 92px;
    }
    .module:hover{
      transform: translateY(-2px);
      border-color: rgba(32,240,208,.30);
      filter: brightness(1.02);
    }
    .module.disabled{
      opacity: .45;
      cursor:not-allowed;
      transform:none !important;
      filter: grayscale(.35);
    }

    .module-top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .micon{
      width: 44px; height: 44px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
      display:grid;
      place-items:center;
      box-shadow: 0 12px 24px rgba(0,0,0,.18);
      flex:0 0 auto;
    }
    .micon svg{ width: 22px; height: 22px; }
    .micon svg path{ fill: rgba(255,255,255,.92); }

    .mgo{
      font-size: 12px;
      font-weight: 1000;
      letter-spacing:.10em;
      text-transform: uppercase;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(32,240,208,.22);
      background: rgba(32,240,208,.10);
      color: rgba(255,255,255,.88);
      white-space:nowrap;
    }

    .module h4{
      margin: 0;
      font-size: 14px;
      font-weight: 1000;
      letter-spacing: .02em;
      text-transform: uppercase;
    }
    .module p{
      margin: 8px 0 0;
      font-size: 12.5px;
      color: rgba(255,255,255,.74);
      line-height: 1.35;
    }

    .foot{
      margin-top: 14px;
      opacity:.75;
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap: 12px;
      flex-wrap:wrap;
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

    /* Buttons for logout (keep compatibility if exists somewhere else) */
    button.logout{
      border: 1px solid rgba(255,255,255,.16);
      background: linear-gradient(135deg, rgba(32,240,208,.22), rgba(102,255,181,.18));
      color: rgba(255,255,255,.92);
      border-radius: 12px;
      padding: 10px 14px;
      cursor:pointer;
      font-weight: 900;
      letter-spacing:.04em;
      box-shadow: 0 12px 18px rgba(0,0,0,.28);
    }

    /* ===== Tooth centerpiece (Resumen r√°pido) ===== */
    /* Realistic tooth glow */
    /* === FIX muela resumen r√°pido === */
    .hero-right{
      position: relative;
    }
    /* TRUE MOLAR enhancement */
    /* ANATOMIC MOLAR FINAL */
    /* Tooth image styling */
    /* Align right-side KPI cards */
    .kpi.right-align{
      text-align: right;
    }

/* ===== Tooth centerpiece FINAL (al frente) ===== */
.tooth-center{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  z-index: 10;
  pointer-events:none;
  display:flex;
  align-items:center;
  justify-content:center;
}
.tooth-center img{
  width:120px;
  height:auto;
  display:block;
  opacity:.98;
  filter:
    drop-shadow(0 0 35px rgba(32,240,208,.75))
    drop-shadow(0 0 70px rgba(32,240,208,.45));
}

</style>
</head>

<body>
  <div class="wrap">
    <!-- TOPBAR -->
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24">
            <path d="M12 2c4.2 0 7.5 2.6 7.5 6.6 0 2.7-1.1 4.9-3.2 6.4V20a2 2 0 0 1-2 2H9.7a2 2 0 0 1-2-2v-4.9C5.6 13.6 4.5 11.4 4.5 8.6 4.5 4.6 7.8 2 12 2Zm-2.6 18h5.2v-4.2l.4-.2c1.8-.9 2.9-2.8 2.9-5 0-2.9-2.4-4.6-5.9-4.6S6.1 5.7 6.1 8.6c0 2.2 1.1 4.1 2.9 5l.4.2V20Z"/>
          </svg>
        </div>
        <div class="brand-title">
          <div class="kicker">Software</div>
          <div class="name">DENTOVA ‚Äî Panel Futurista</div>
        </div>
      </div>

      <div class="top-actions">
        <div class="chip"><span class="dot"></span> Sesi√≥n activa</div>
        <div class="mini-meta">
          <span id="user-email"></span>
          <span id="user-role">Rol: ...</span>
          <button class="btn" type="button" onclick="cerrarSesion()">Cerrar sesi√≥n</button>
        </div>
      </div>
    </div>

    <!-- HERO -->
    <section class="hero">
      <div class="hero-grid">
        <div class="hero-left">
          <h1 class="headline">
            DENTOVA <span class="neon">IIIIIIIIIIIIII</span><br/>
            LEIDI SILVA ODONTOLOG√çA
          </h1>
          <p class="sub">Panel premium con glassmorphism y m√≥dulos inteligentes para tu sistema de odontolog√≠a.</p>
          <div class="cta-row">
            <button class="cta-big" type="button" onclick="document.getElementById('mods').scrollIntoView({behavior:'smooth'})">Empezar ahora</button>
            <button class="cta-ghost" type="button" onclick="document.getElementById('mods').scrollIntoView({behavior:'smooth'})">Ver m√≥dulos</button>
          </div>
        </div>

        <div class="hero-right" aria-label="Resumen r√°pido">
          <div class="circuit"></div>
          <div class="scanline"></div>

          <!-- Tooth centerpiece -->
          <!-- Tooth centerpiece (realistic molar) -->
          <!-- Tooth centerpiece (TRUE MOLAR) -->
          <!-- Tooth centerpiece (ANATOMIC MOLAR) -->
          <!-- Tooth centerpiece (IMAGE) -->
          <div class="tooth-center" aria-hidden="true">
            <img src="https://static.wixstatic.com/media/63e6ec_5374fe6f441940e09de8a9672bec9db1~mv2.png/v1/fill/w_123,h_148,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/muela1.png"
                 alt="Muela"
                 loading="eager" />
          </div>


          <div class="kpi-grid">
            <div class="kpi">
              <div class="label">Citas hoy</div>
              <div class="value" id="citas-hoy-value">12</div>
              <div class="hint" id="citas-hoy-hint">Actualizando...</div>
            </div>
            <div class="kpi right-align">
              <div class="label">Pacientes</div>
              <div class="value" id="pacientes-value">‚Äî</div>
              <div class="hint" id="pacientes-hint">Actualizando...</div>
            </div>
            <div class="kpi">
              <div class="label">Facturas</div>
              <div class="value">$ 8.9M</div>
              <div class="hint">Semana actual</div>
            </div>
            <div class="kpi right-align">
              <div class="label">Alertas</div>
              <div class="value">2</div>
              <div class="hint">Seguimientos</div>
            </div>
          </div>
        </div>
      </div>

      <!-- MODULES (TODOS LOS IDS DEL ORIGINAL) -->
      <div class="modules" id="mods">
        <a class="module" href="#" id="go-reporte-ventas">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M4 20V4h2v16H4Zm4 0V10h2v10H8Zm4 0V6h2v14h-2Zm4 0V13h2v7h-2Zm4 0V8h2v12h-2Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Reporte ventas</h4>
          <p>Visualizar reportes de ventas.</p>
        </a>

        <a class="module" href="#" id="go-agendar">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M7 2h2v2h6V2h2v2h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h3V2Zm15 8H2v10h20V10Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Agendar</h4>
          <p>Ir al enlace de citas.</p>
        </a>

        <a class="module" href="#" id="go-gestiondepermisos">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 2 4 5v6c0 5 3.4 9.7 8 11 4.6-1.3 8-6 8-11V5l-8-3Zm0 6a3 3 0 1 1 0 6 3 3 0 0 1 0-6Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Gesti√≥n de permisos</h4>
          <p>Permisos y accesos por rol.</p>
        </a>

        <a class="module" href="#" id="go-historia">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M7 2h7l5 5v15a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2Zm6 1.8V8h4.2L13 3.8Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Historia cl√≠nica</h4>
          <p>Gesti√≥n del paciente.</p>
        </a>

        <a class="module" href="#" id="go-reporte-pacientes">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M4 4h16v16H4V4Zm3 4h10v2H7V8Zm0 4h10v2H7v-2Zm0 4h6v2H7v-2Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Reporte de pacientes</h4>
          <p>Buscar por c√©dula o nombre.</p>
        </a>

        <a class="module" href="#" id="go-plan">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M9 4h6l1 2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3l1-2Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Plan de tratamiento</h4>
          <p>Registrar procedimientos.</p>
        </a>

        <a class="module" href="#" id="go-hoy">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Zm0-16v6l4 2"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Pacientes hoy</h4>
          <p>Agendados para hoy.</p>
        </a>

        <a class="module" href="#" id="go-rips">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M4 20V10h4v10H4Zm6 0V4h4v16h-4Zm6 0V8h4v12h-4Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>RIPS</h4>
          <p>Solo administrador.</p>
        </a>

        <a class="module" href="#" id="go-registro">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4.4 0-8 2.2-8 5v1h16v-1c0-2.8-3.6-5-8-5Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Registrar usuarios</h4>
          <p>Solo administrador.</p>
        </a>

        <a class="module" href="#" id="go-usuarios">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M8 11c1.66 0 3-1.34 3-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3Zm8 0c1.66 0 3-1.34 3-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Usuarios registrados</h4>
          <p>Administrar roles.</p>
        </a>

        <a class="module" href="#" id="go-precios">
  <div class="module-top">
    <div class="micon" aria-hidden="true">
  <svg viewBox="0 0 24 24">
    <path d="M11 2h2v2h2.5a3.5 3.5 0 0 1 0 7H13v2h2a3.5 3.5 0 0 1 0 7H13v2h-2v-2H8.5a3.5 3.5 0 0 1 0-7H11v-2H9a3.5 3.5 0 0 1 0-7H11V2Z"/>
  </svg>
</div>
    <span class="mgo">Abrir</span>
  </div>
  <h4>Actualizaci√≥n de precios</h4>
  <p>Editar y agregar procedimientos.</p>
</a>


        <a class="module" href="#" id="go-profesionales">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm-6 8c0-3.3 2.7-6 6-6s6 2.7 6 6"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Profesionales</h4>
          <p>Crear, editar y eliminar (solo admin).</p>
        </a>

        <a class="module" href="#" id="go-facturacion">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M7 2h10a2 2 0 0 1 2 2v18l-3-2-3 2-3-2-3 2V4a2 2 0 0 1 2-2Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Facturaci√≥n</h4>
          <p>Crear y guardar facturas (solo admin).</p>
        </a>

        <!-- ‚úÖ NUEVO: GASTOS -->
        <a class="module" href="#" id="go-gastos">
          <div class="module-top">
            <div class="micon" aria-hidden="true">
              <!-- Icono (wallet) -->
              <svg viewBox="0 0 24 24"><path d="M20 7H6a2 2 0 0 1 0-4h12a2 2 0 0 1 2 2v2Zm0 2a2 2 0 0 1 2 2v7a3 3 0 0 1-3 3H6a4 4 0 0 1 0-8h14Zm-2 5a1.5 1.5 0 1 0 0 3h2v-3h-2Z"/></svg>
            </div>
            <span class="mgo">Abrir</span>
          </div>
          <h4>Gastos</h4>
          <p>Registrar y consultar gastos.</p>
        </a>
      </div>

      <div class="foot">
        <div>¬© <span id="year"></span> Cl√≠nica Dra. Leidi Silva</div>
        <div class="mono">Fecha: <span id="today"></span></div>
      </div>
    </section>
  </div>
</body>
</html>








